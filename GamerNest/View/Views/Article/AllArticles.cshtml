@model Support.ModelList
@{
    ViewData[ "Title" ] = "All Articles";
}

<partial name="_NormalMenu" />

<main class="home-user">
    <div class="text">
        <h1>All Articles</h1>
        <div class="NormalCenter">
            <section class="filter">
                <form asp-controller="Article" asp-action="AllArticles" method="post">
                    <div>
                        <select id="orderBy" name="orderBy">
                            <option value="createdDate">Order By</option>
                            <option value="headline">Headline</option>
                            <option value="createdDate">Created Date</option>
                        </select>
                    </div>
                    @if ( ViewData[ "UserEmail" ].ToString() != "no" )
                    {
                        <div>
                            <div class="input-group">
                                <select name="isFav" id="isFav">
                                    <option value="false">No Show Fav</option>
                                    <option value="true">Show Fav</option>
                                </select>
                            </div>
                        </div>
                    }

                    <div>
                        <div class="input-group">
                            <span class="input-icon"><i class="fa-solid fa-magnifying-glass"></i></span>
                            <input type="text" id="headline" name="headline" placeholder="Search Headline">
                        </div>
                    </div>
                    <div>
                        <div class="input-group">
                            <select name="language" id="language">
                                <option value="">@ViewData[ "fSearchLanguage" ]</option>
                                <option value="ENG">ENG</option>
                                <option value="ESP">ESP</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <input class="filtButton" type="submit" value="Filter">
                    </div>
                </form>
            </section>
        </div>
        <section class="news">
            @foreach ( var item in Model.articleList )
            {
                <a asp-controller="Article" asp-action="SeeArticle" asp-route-id="@item.id">
                    <div class="card">
                        <div class="img">
                            <img src="@item.cover" alt="Cover">
                        </div>
                        <div class="info">
                            <div class="headline">
                                @item.headline
                            </div>
                            <div class="summary">
                                @Html.Raw(item.summary)
                            </div>
                            <div class="date">
                                @item.createdDate
                            </div>
                        </div>
                    </div>

                </a>
            }

        </section>
        <section class="pagination">
            <div>
                @if ( Model.CurrentPage > 1 )
                {
                    <!-- Previous Page -->
                    <a asp-controller="Article" asp-action="AllArticles"
                   asp-route-page="@(Model.CurrentPage - 1)"
                   asp-route-pageSize="@Model.PageSize"
                   asp-route-language="@ViewBag.FormData.language"
                   asp-route-idAuthor="@ViewBag.FormData.author"
                   asp-route-idGame="@ViewBag.FormData.idGame"
                   asp-route-id="@ViewBag.FormData.id"
                   asp-route-headline="@ViewBag.FormData.headline"
                   asp-route-isPublished="@ViewBag.FormData.isPublished"
                   asp-route-orderBy="@ViewBag.FormData.orderBy"
                   asp-route-isFav="@ViewBag.FormData.isFav"
                   asp-route-user="@ViewBag.FormData.user">
                        Previous
                    </a>
                }

                @if ( Model.CurrentPage < Math.Ceiling( (double) Model.TotalItems / Model.PageSize ) )
                {
                    <!-- Next Page -->
                    <a asp-controller="Article" asp-action="AllArticles"
                   asp-route-page="@(Model.CurrentPage + 1)"
                   asp-route-pageSize="@Model.PageSize"
                   asp-route-language="@ViewBag.FormData.language"
                   asp-route-idAuthor="@ViewBag.FormData.author"
                   asp-route-idGame="@ViewBag.FormData.idGame"
                   asp-route-id="@ViewBag.FormData.id"
                   asp-route-headline="@ViewBag.FormData.headline"
                   asp-route-isPublished="@ViewBag.FormData.isPublished"
                   asp-route-orderBy="@ViewBag.FormData.orderBy"
                   asp-route-isFav="@ViewBag.FormData.isFav"
                   asp-route-user="@ViewBag.FormData.user">
                        Next
                    </a>
                }
            </div>
            <div>
                <p>
                    @ViewData[ "Page" ] @Model.CurrentPage @ViewData[ "Of" ] @Math.Ceiling((double)Model.TotalItems / Model.PageSize) (@Model.articleList?.Count @ViewData[ "OutOf" ] @Model.TotalItems)
                </p>
            </div>
        </section>
    </div>
</main>
